import{r as p,j as e,b as v}from"./index-ClSJhwQF.js";const S="https://new-json.onrender.com";function L(){const[l,w]=p.useState([]),[h,N]=p.useState([]),[m,z]=p.useState({}),[f,D]=p.useState({key:"group_active_date",direction:"desc"}),[c,_]=p.useState({roomName:"",leader:"",status:"全部狀態"});p.useEffect(()=>{(async()=>{try{const a=await v.get(`${S}/groupsData`);w(a.data),N(a.data);const j=[...new Set(a.data.map(t=>t.user_id))];try{const t=j.map(x=>v.get(`${S}/usersData/${x}`)),i=await Promise.all(t),o={};i.forEach(x=>{const r=x.data;o[r.id]=r}),z(o)}catch(t){console.log(t.response.data.errors[0])}}catch(a){console.log(a.response.data.errors[0])}})()},[]);const g=s=>{_({...c,[s.target.id]:s.target.value})},B=()=>{const s=l.filter(a=>{const j=c.roomName===""||a.game_name.toLowerCase().includes(c.roomName.toLowerCase());let t=c.leader==="";!t&&m[a.user_id]&&(t=m[a.user_id].user_name.toLowerCase().includes(c.leader.toLowerCase()));const i=C(a),o=c.status==="全部狀態"||i===c.status;return j&&t&&o});N(s)},G=()=>{_({roomName:"",leader:"",status:"全部狀態"}),N(l)},u=s=>{let a="asc";f.key===s&&f.direction==="asc"&&(a="desc"),D({key:s,direction:a});const j=[...h].sort((t,i)=>{var o,x;if(s==="group_isSuccessful"){const r=b=>b.group_isEnd?3:b.group_cancel?2:b.group_isSuccessful?1:0,n=r(t),y=r(i);return a==="asc"?n-y:y-n}if(s==="group_id"||s==="group_member"){const r=parseInt(t[s],10),n=parseInt(i[s],10);return a==="asc"?r-n:n-r}if(s==="group_end_at"||s==="group_active_date"){const r=new Date(t[s]),n=new Date(i[s]);return a==="asc"?r-n:n-r}if(s==="user_id"){const r=((o=m[t[s]])==null?void 0:o.user_name)||"",n=((x=m[i[s]])==null?void 0:x.user_name)||"";return a==="asc"?r.localeCompare(n):n.localeCompare(r)}return a==="asc"?String(t[s]).localeCompare(String(i[s])):String(i[s]).localeCompare(String(t[s]))});N(j)},d=s=>f.key!==s?e.jsx("div",{}):f.direction==="asc"?e.jsx("span",{className:"material-symbols-outlined",style:{fontSize:"18px",position:"absolute",padding:"3px 0"},children:"arrow_upward"}):e.jsx("span",{className:"material-symbols-outlined",style:{fontSize:"18px",position:"absolute",padding:"3px 0"},children:"arrow_downward"});return e.jsx("div",{className:"custom-adminBg",children:e.jsxs("div",{className:"adminUser container pt-11 pb-6",children:[e.jsx("nav",{style:{"--bs-breadcrumb-divider":"'>'"},"aria-label":"breadcrumb",children:e.jsx("ol",{className:"breadcrumb",children:e.jsx("li",{className:"breadcrumb-item",children:e.jsx("span",{className:"fs-Body-2 fw-bold text-nature-50",children:"揪團資料"})})})}),e.jsxs("div",{className:"searchBar mt-5 mb-6 row",children:[e.jsxs("div",{className:"col-6 col-lg-2",children:[e.jsx("label",{htmlFor:"roomName",className:"form-label fs-Caption text-black",children:"密室名稱"}),e.jsx("input",{type:"text",className:"form-control bg-transparent border-black",id:"roomName",placeholder:"請輸入內容",value:c.roomName,onChange:g})]}),e.jsxs("div",{className:"col-6 col-lg-2",children:[e.jsx("label",{htmlFor:"leader",className:"form-label fs-Caption text-black",children:"主揪人"}),e.jsx("input",{type:"text",className:"form-control bg-transparent border-black",id:"leader",placeholder:"請輸入內容",value:c.leader,onChange:g})]}),e.jsxs("div",{className:"col-6 col-lg-2",children:[e.jsx("label",{htmlFor:"status",className:"form-label fs-Caption text-black",children:"狀態"}),e.jsxs("select",{className:"form-select border-black",id:"status",value:c.status,onChange:g,children:[e.jsx("option",{value:"全部狀態",children:"全部狀態"}),e.jsx("option",{value:"揪團中",children:"揪團中"}),e.jsx("option",{value:"已棄團",children:"已棄團"}),e.jsx("option",{value:"已結束",children:"已結束"})]})]}),e.jsx("div",{className:"col-lg-1 d-flex align-items-end",children:e.jsx("button",{className:"btn btn-search btn-primary-50 text-white form-control my-3 my-lg-0",onClick:B,children:"搜尋"})}),e.jsx("div",{className:"col-lg-1 d-flex align-items-end",children:e.jsx("button",{className:"btn btn-reset btn-outline-secondary form-control",onClick:G,children:"重置"})})]}),e.jsx("div",{className:"table-container d-none d-lg-block bg-white border rounded-2 border-nature-90 p-6",children:e.jsx("div",{className:"table-scroll-container overflow-scroll",children:e.jsxs("table",{className:"storeTable w-100",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsxs("th",{className:"px-4 py-3",onClick:()=>u("group_id"),children:["ID ",d("group_id")]}),e.jsxs("th",{className:"px-4 py-3",onClick:()=>u("game_name"),children:["密室名稱 ",d("game_name")]}),e.jsxs("th",{className:"px-4 py-3",onClick:()=>u("user_id"),children:["主揪人 ",d("user_id")]}),e.jsxs("th",{className:"px-4 py-3",onClick:()=>u("group_member"),children:["總人數 ",d("group_member")]}),e.jsxs("th",{className:"px-4 py-3",children:["狀態 ",d("group_isSuccessful")]}),e.jsxs("th",{className:"px-4 py-3",onClick:()=>u("group_end_at"),children:["揪團截止日期 ",d("group_end_at")]}),e.jsxs("th",{className:"px-4 py-3",onClick:()=>u("group_active_date"),children:["活動日期 ",d("group_active_date")]}),e.jsx("th",{className:"px-4 py-3"})]})}),e.jsx("tbody",{children:h.length>0?h.map(s=>{var a;return e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 px-4",children:s.group_id}),e.jsx("td",{className:"py-2 px-4",children:s.game_name}),e.jsx("td",{className:"py-2 px-4",children:((a=m[s.user_id])==null?void 0:a.user_name)||"未知用戶"}),e.jsx("td",{className:"py-2 px-4",children:s.group_member}),e.jsx("td",{className:"py-2 px-4",children:e.jsx("span",{className:`px-2 py-1 rounded-2 text-black ${A(s)}`,children:C(s)})}),e.jsx("td",{className:"py-2 px-4",children:s.group_end_at}),e.jsx("td",{className:"py-2 px-4",children:s.group_active_date}),e.jsx("td",{className:"py-2 px-4 text-end",children:e.jsx("button",{className:"edit-btn d-flex align-items-center justify-content-center",children:e.jsx("span",{className:"material-symbols-outlined",children:"edit"})})})]},s.group_id)}):e.jsx("tr",{children:e.jsx("td",{className:"text-center py-2",colSpan:7,children:"沒有符合的資料"})})})]})})}),e.jsx("div",{className:"cards-container d-lg-none row row-cols-1 row-cols-md-2 g-3",children:h.length>0?h.map(s=>{var a;return e.jsx("div",{className:"col",children:e.jsx("div",{className:"card card-admin",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsxs("span",{className:"me-2 px-2 fs-6 rounded-3 bg-secondary-95",style:{fontSize:"0.8rem"},children:["ID: ",s.group_id]}),e.jsx("p",{className:"fw-bold fs-1",children:s.game_name})]}),e.jsx("button",{className:"edit-btn d-flex align-items-center justify-content-center",children:e.jsx("span",{className:"material-symbols-outlined",children:"edit"})})]}),e.jsx("div",{className:"status my-4",children:E(s)}),e.jsxs("div",{className:"content row row-cols-2",children:[e.jsxs("div",{className:"user d-flex align-items-center",children:[e.jsx("span",{className:"material-symbols-outlined me-1 text-nature-50",children:"person"}),e.jsxs("div",{className:"d-flex flex-column",children:[e.jsx("p",{className:"text-nature-50",style:{fontSize:"0.8rem"},children:"主揪人"}),e.jsx("p",{className:"fw-bold",style:{fontSize:"0.8rem"},children:((a=m[s.user_id])==null?void 0:a.user_name)||"未知用戶"})]})]}),e.jsxs("div",{className:"user d-flex align-items-center",children:[e.jsx("span",{className:"material-symbols-outlined me-1 text-nature-50",children:"groups"}),e.jsxs("div",{className:"d-flex flex-column",children:[e.jsx("p",{className:"text-nature-50",style:{fontSize:"0.8rem"},children:"總人數"}),e.jsx("p",{className:"fw-bold",style:{fontSize:"0.8rem"},children:s.group_member})]})]})]}),e.jsx("div",{className:"text-nature-60",children:e.jsx("hr",{})}),e.jsxs("div",{className:"date row row-cols-2",children:[e.jsxs("div",{className:"end_date d-flex align-items-center",children:[e.jsx("span",{className:"material-symbols-outlined me-1 text-nature-50",children:"calendar_month"}),e.jsxs("div",{className:"d-flex flex-column",children:[e.jsx("p",{className:"text-nature-50",style:{fontSize:"0.8rem"},children:"揪團截止日期"}),e.jsx("p",{className:"fw-bold",style:{fontSize:"0.8rem"},children:s.group_end_at})]})]}),e.jsxs("div",{className:"active_date d-flex align-items-center",children:[e.jsx("span",{className:"material-symbols-outlined me-1 text-nature-50",children:"calendar_month"}),e.jsxs("div",{className:"d-flex flex-column",children:[e.jsx("p",{className:"text-nature-50",style:{fontSize:"0.8rem"},children:"活動日期"}),e.jsx("p",{className:"fw-bold",style:{fontSize:"0.8rem"},children:s.group_active_date})]})]})]})]})})},s.group_id)}):e.jsx("div",{className:"col",children:e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body text-center py-4",children:"沒有符合的資料"})})})})]})})}const A=l=>l.group_isSuccessful?"bg-nature-90":l.group_cancel?"bg-tertiary-90":"bg-secondary-90",C=l=>l.group_isSuccessful?"已結束":l.group_cancel?"已棄團":"揪團中",E=l=>l.group_isSuccessful?e.jsxs("div",{className:"d-inline-flex align-items-center bg-nature-90 px-2 rounded-2 border border-nature-60",style:{height:"26px"},children:[e.jsx("span",{className:"material-symbols-outlined me-1 text-nature-60",style:{fontSize:"1rem"},children:"event_busy"}),e.jsx("p",{className:"text-nature-50",style:{fontSize:"0.8rem"},children:"已結束"})]}):l.group_cancel?e.jsxs("div",{className:"d-inline-flex align-items-center bg-primary-95 px-2 rounded-2 border border-primary-80",children:[e.jsx("span",{className:"material-symbols-outlined me-1 text-danger",children:"close_small"}),e.jsx("p",{className:"text-primary-50",style:{fontSize:"0.8rem"},children:"已棄團"})]}):e.jsxs("div",{className:"d-inline-flex align-items-center bg-secondary-90 px-2 rounded-2 border border-secondary-80",style:{height:"26px"},children:[e.jsx("span",{className:"material-symbols-outlined me-1 text-secondary-50",style:{fontSize:"0.8rem"},children:"progress_activity"}),e.jsx("p",{className:"text-secondary-60",style:{fontSize:"0.8rem"},children:"揪團中"})]});export{L as default};
